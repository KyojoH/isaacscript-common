<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>features/saveDataManager/exports | isaacscript-common</title><meta name="description" content="Documentation for isaacscript-common"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">isaacscript-common</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">isaacscript-common</a></li><li><a href="features_saveDataManager_exports.html">features/saveDataManager/exports</a></li></ul><h1>Module features/saveDataManager/exports</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section "><h3>Functions</h3><ul class="tsd-index-list"><li class="tsd-kind-function tsd-parent-kind-module"><a href="features_saveDataManager_exports.html#saveDataManager" class="tsd-kind-icon">save<wbr/>Data<wbr/>Manager</a></li><li class="tsd-kind-function tsd-parent-kind-module"><a href="features_saveDataManager_exports.html#saveDataManagerSave" class="tsd-kind-icon">save<wbr/>Data<wbr/>Manager<wbr/>Save</a></li><li class="tsd-kind-function tsd-parent-kind-module"><a href="features_saveDataManager_exports.html#saveDataManagerSetGlobal" class="tsd-kind-icon">save<wbr/>Data<wbr/>Manager<wbr/>Set<wbr/>Global</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Functions</h2><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-module"><a id="saveDataManager" class="tsd-anchor"></a><h3>save<wbr/>Data<wbr/>Manager</h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-module"><li class="tsd-signature tsd-kind-icon">save<wbr/>Data<wbr/>Manager<span class="tsd-signature-symbol">(</span>key<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span>, saveData<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">SaveData</span>, conditionalFunc<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/IsaacScript/isaacscript-common/blob/1b5a8ac/src/features/saveDataManager/exports.ts#L84">features/saveDataManager/exports.ts:84</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>This is the entry point to the save data manager, a system which provides two major features:</p>
</div><div><ol>
<li>automatic resetting of variables on a new run, on a new level, or on a new room (as desired)</li>
<li>automatic saving and loading of all tracked data to the &quot;save#.dat&quot; file</li>
</ol>
<p>The save data manager never exposes any data, ensuring that all of the files in your mod have
variables that are properly scoped.</p>
<p>Example:</p>
<pre><code><span class="hl-9">// in file: feature1.ts</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">saveDataManager</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;isaacscript-common&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-9">// Declare local variables for this file or feature</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">v</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-9">// These variables are never reset; manage them yourself at will</span><br/><span class="hl-1">  </span><span class="hl-2">persistent:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">foo1:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><br/><span class="hl-1">  </span><span class="hl-9">// These variables are reset at the beginning of every run</span><br/><span class="hl-1">  </span><span class="hl-2">run:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">foo2:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><br/><span class="hl-1">  </span><span class="hl-9">// These variables are reset at the beginning of every level</span><br/><span class="hl-1">  </span><span class="hl-2">level:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">foo3:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><br/><span class="hl-1">  </span><span class="hl-9">// These variables are reset at the beginning of every room</span><br/><span class="hl-1">  </span><span class="hl-2">room:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">foo2:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">};</span><br/><span class="hl-9">// (every child object is optional; only create the ones that you need)</span><br/><br/><span class="hl-9">// Register the variables with the save data manager</span><br/><span class="hl-9">// (we need to provide a string key so that it can save the variables properly in the</span><br/><span class="hl-9">// &quot;save#.dat&quot; file)</span><br/><span class="hl-7">saveDataManager</span><span class="hl-1">(</span><span class="hl-3">&quot;feature1&quot;</span><span class="hl-1">, </span><span class="hl-2">v</span><span class="hl-1">);</span><br/><br/><span class="hl-9">// Elsewhere in the file, use your variables</span><br/><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-7">feature1Function</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">v</span><span class="hl-1">.</span><span class="hl-2">run</span><span class="hl-1">.</span><span class="hl-2">foo1</span><span class="hl-1"> &gt; </span><span class="hl-6">0</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-9">// Do stuff</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
<ul>
<li>Save data is loaded from disk in the MC_POST_PLAYER_INIT callback
(i.e. the first callback that can possibly run).</li>
<li>Save data is recorded to disk in the MC_PRE_GAME_EXIT callback.</li>
</ul>
<p>Note that before using the save data manager, you must call the <a href="upgradeMod.html"><code>upgradeMod</code></a> function.</p>
<p>Finally, some features may have variables that need to be automatically reset per run/level, but
not saved to disk on game exit. (For example, if they contain functions or other non-serializable
data.) For these cases, set a special key of &quot;dontSave&quot; alongside &quot;run&quot;, &quot;level&quot;, and so forth.</p>
</div></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>key: <span class="tsd-signature-type">string</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The name of the file or feature that is submitting data to be managed by the save data
manager. The save data manager will throw an error if the key is already registered.</p>
</div></div></li><li><h5>saveData: <span class="tsd-signature-type">SaveData</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>An object that corresponds to the <code>SaveData</code> interface. The object is
conventionally called &quot;v&quot; for brevity (which is short for &quot;local variables&quot;).</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> conditionalFunc: <span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type">boolean</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>An optional function to run upon saving this key to disk. If the function
is false, the key will not be written to disk. This allows mod features to avoid cluttering the
&quot;save#.dat&quot; file with unnecessary keys.</p>
</div></div><ul class="tsd-parameters"><li class="tsd-parameter-signature"><ul class="tsd-signatures tsd-kind-type-literal"><li class="tsd-signature tsd-kind-icon"><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">boolean</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">boolean</span></h4></li></ul></li></ul></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-module"><a id="saveDataManagerSave" class="tsd-anchor"></a><h3>save<wbr/>Data<wbr/>Manager<wbr/>Save</h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-module"><li class="tsd-signature tsd-kind-icon">save<wbr/>Data<wbr/>Manager<wbr/>Save<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/IsaacScript/isaacscript-common/blob/1b5a8ac/src/features/saveDataManager/exports.ts#L132">features/saveDataManager/exports.ts:132</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>The save data manager will automatically save variables to disk at the appropriate times (i.e.
when the run is exited). Use this function to explicitly force the save data manager to write all
of its variables to disk immediately.</p>
</div></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-module"><a id="saveDataManagerSetGlobal" class="tsd-anchor"></a><h3>save<wbr/>Data<wbr/>Manager<wbr/>Set<wbr/>Global</h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-module"><li class="tsd-signature tsd-kind-icon">save<wbr/>Data<wbr/>Manager<wbr/>Set<wbr/>Global<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/IsaacScript/isaacscript-common/blob/1b5a8ac/src/features/saveDataManager/exports.ts#L150">features/saveDataManager/exports.ts:150</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Sets the global variable of &quot;g&quot; equal to all of the save data variables for this mod.
Sets the global variable of &quot;gd&quot; equal to all of the save data default variables for this mod.
This can make debugging easier, as you can access the variables from the game&#39;s debug console.
e.g. <code>l print(g.feature1.foo)</code></p>
</div></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4></li></ul></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Modules</a></li><li class=" tsd-kind-module"><a href="constants.html">constants</a></li><li class=" tsd-kind-module"><a href="features_deployJSONRoom.html">features/deployJSONRoom</a></li><li class=" tsd-kind-module"><a href="features_disableInputs.html">features/disable<wbr/>Inputs</a></li><li class=" tsd-kind-module"><a href="features_forgottenSwitch.html">features/forgotten<wbr/>Switch</a></li><li class=" tsd-kind-module"><a href="features_getCollectibleItemPoolType.html">features/get<wbr/>Collectible<wbr/>Item<wbr/>Pool<wbr/>Type</a></li><li class=" tsd-kind-module"><a href="features_preventCollectibleRotate.html">features/prevent<wbr/>Collectible<wbr/>Rotate</a></li><li class=" tsd-kind-module"><a href="features_runInNFrames.html">features/run<wbr/>InNFrames</a></li><li class="current tsd-kind-module"><a href="features_saveDataManager_exports.html">features/save<wbr/>Data<wbr/>Manager/exports</a></li><li class=" tsd-kind-module"><a href="features_sirenHelpers.html">features/siren<wbr/>Helpers</a></li><li class=" tsd-kind-module"><a href="functions_array.html">functions/array</a></li><li class=" tsd-kind-module"><a href="functions_bitwise.html">functions/bitwise</a></li><li class=" tsd-kind-module"><a href="functions_cards.html">functions/cards</a></li><li class=" tsd-kind-module"><a href="functions_charge.html">functions/charge</a></li><li class=" tsd-kind-module"><a href="functions_collectibleSet.html">functions/collectible<wbr/>Set</a></li><li class=" tsd-kind-module"><a href="functions_collectibles.html">functions/collectibles</a></li><li class=" tsd-kind-module"><a href="functions_color.html">functions/color</a></li><li class=" tsd-kind-module"><a href="functions_debug.html">functions/debug</a></li><li class=" tsd-kind-module"><a href="functions_deepCopy.html">functions/deep<wbr/>Copy</a></li><li class=" tsd-kind-module"><a href="functions_doors.html">functions/doors</a></li><li class=" tsd-kind-module"><a href="functions_entity.html">functions/entity</a></li><li class=" tsd-kind-module"><a href="functions_familiars.html">functions/familiars</a></li><li class=" tsd-kind-module"><a href="functions_flag.html">functions/flag</a></li><li class=" tsd-kind-module"><a href="functions_gridEntity.html">functions/grid<wbr/>Entity</a></li><li class=" tsd-kind-module"><a href="functions_input.html">functions/input</a></li><li class=" tsd-kind-module"><a href="functions_json.html">functions/json</a></li><li class=" tsd-kind-module"><a href="functions_language.html">functions/language</a></li><li class=" tsd-kind-module"><a href="functions_log.html">functions/log</a></li><li class=" tsd-kind-module"><a href="functions_math.html">functions/math</a></li><li class=" tsd-kind-module"><a href="functions_npc.html">functions/npc</a></li><li class=" tsd-kind-module"><a href="functions_pickups.html">functions/pickups</a></li><li class=" tsd-kind-module"><a href="functions_pills.html">functions/pills</a></li><li class=" tsd-kind-module"><a href="functions_player.html">functions/player</a></li><li class=" tsd-kind-module"><a href="functions_playerHealth.html">functions/player<wbr/>Health</a></li><li class=" tsd-kind-module"><a href="functions_pocketItems.html">functions/pocket<wbr/>Items</a></li><li class=" tsd-kind-module"><a href="functions_position.html">functions/position</a></li><li class=" tsd-kind-module"><a href="functions_random.html">functions/random</a></li><li class=" tsd-kind-module"><a href="functions_revive.html">functions/revive</a></li><li class=" tsd-kind-module"><a href="functions_rooms.html">functions/rooms</a></li><li class=" tsd-kind-module"><a href="functions_seeds.html">functions/seeds</a></li><li class=" tsd-kind-module"><a href="functions_spawnCollectible.html">functions/spawn<wbr/>Collectible</a></li><li class=" tsd-kind-module"><a href="functions_sprite.html">functions/sprite</a></li><li class=" tsd-kind-module"><a href="functions_stage.html">functions/stage</a></li><li class=" tsd-kind-module"><a href="functions_tears.html">functions/tears</a></li><li class=" tsd-kind-module"><a href="functions_transformations.html">functions/transformations</a></li><li class=" tsd-kind-module"><a href="functions_trinketGive.html">functions/trinket<wbr/>Give</a></li><li class=" tsd-kind-module"><a href="functions_trinketSet.html">functions/trinket<wbr/>Set</a></li><li class=" tsd-kind-module"><a href="functions_trinkets.html">functions/trinkets</a></li><li class=" tsd-kind-module"><a href="functions_ui.html">functions/ui</a></li><li class=" tsd-kind-module"><a href="functions_util.html">functions/util</a></li><li class=" tsd-kind-module"><a href="functions_vector.html">functions/vector</a></li><li class=" tsd-kind-module"><a href="index.html">index</a></li><li class=" tsd-kind-module"><a href="maps_cardDescriptionMap.html">maps/card<wbr/>Description<wbr/>Map</a></li><li class=" tsd-kind-module"><a href="maps_cardNameMap.html">maps/card<wbr/>Name<wbr/>Map</a></li><li class=" tsd-kind-module"><a href="maps_collectibleDescriptionMap.html">maps/collectible<wbr/>Description<wbr/>Map</a></li><li class=" tsd-kind-module"><a href="maps_collectibleNameMap.html">maps/collectible<wbr/>Name<wbr/>Map</a></li><li class=" tsd-kind-module"><a href="maps_gridEntityXMLMap.html">maps/grid<wbr/>EntityXMLMap</a></li><li class=" tsd-kind-module"><a href="maps_pillEffectNameMap.html">maps/pill<wbr/>Effect<wbr/>Name<wbr/>Map</a></li><li class=" tsd-kind-module"><a href="maps_roomShapeToTopLeftWallGridIndexMap.html">maps/room<wbr/>Shape<wbr/>To<wbr/>Top<wbr/>Left<wbr/>Wall<wbr/>Grid<wbr/>Index<wbr/>Map</a></li><li class=" tsd-kind-module"><a href="maps_trinketDescriptionMap.html">maps/trinket<wbr/>Description<wbr/>Map</a></li><li class=" tsd-kind-module"><a href="maps_trinketNameMap.html">maps/trinket<wbr/>Name<wbr/>Map</a></li><li class=" tsd-kind-module"><a href="upgradeMod.html">upgrade<wbr/>Mod</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-function tsd-parent-kind-module"><a href="features_saveDataManager_exports.html#saveDataManager" class="tsd-kind-icon">save<wbr/>Data<wbr/>Manager</a></li><li class="tsd-kind-function tsd-parent-kind-module"><a href="features_saveDataManager_exports.html#saveDataManagerSave" class="tsd-kind-icon">save<wbr/>Data<wbr/>Manager<wbr/>Save</a></li><li class="tsd-kind-function tsd-parent-kind-module"><a href="features_saveDataManager_exports.html#saveDataManagerSetGlobal" class="tsd-kind-icon">save<wbr/>Data<wbr/>Manager<wbr/>Set<wbr/>Global</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li><li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li><li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li><li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>